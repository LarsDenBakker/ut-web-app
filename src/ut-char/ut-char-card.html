<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/paper-card/paper-card.html">
<link rel="import" href="../../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../../bower_components/iron-flex-layout/iron-flex-layout-classes.html">
<link rel="import" href="../../bower_components/iron-icons/editor-icons.html">
<link rel="import" href="../../bower_components/iron-icons/iron-icons.html">

<dom-module id="ut-char-card">
    <style is="custom-style" include="iron-flex iron-flex-alignment">
        paper-card {
            max-width: 600px;
            padding: 5px;
            box-shadow: 0 2px 2px 0 rgba(0, 0, 0, 0.14), 0 1px 5px 0 rgba(0, 0, 0, 0.12), 0 3px 1px -2px rgba(0, 0, 0, 0.2);
        }

        #content {
            padding: 10px;
        }

        #charBio {
            padding: 10px;
        }

        #charProfile {
            padding: 15px;
        }
    </style>
    <template>


        <ut-char-data id="charData" char-data="{{charData}}"></ut-char-data>

        <div id="content" class="horizontal layout center-justified" hidden$="{{!_validCharSelected}}">
            <a href="/characters">
                <paper-icon-button icon="arrow-back"></paper-icon-button>
            </a>
            <paper-card heading="{{char.nickname}}">

                <div class="card-content horizontal layout wrap">

                    <div id="charImage">
                        <iron-image src="{{char.image}}" fade="true"></iron-image>
                    </div>

                    <div id="charBio">
                        <div hidden$="{{!char.firstName}}">First name: {{char.firstName}}</div>
                        <div hidden$="{{!char.lastName}}">Last name: {{char.lastName}}</div>
                        <div hidden$="{{!char.gender}}">Gender: {{char.gender}}</div>
                        <div hidden$="{{!char.race}}">Race: {{char.race}}</div>
                        <div hidden$="{{!char.faith}}">Faith: {{char.faith}}</div>
                        <div hidden$="{{!char.age}}">Age: {{char.age}}</div>
                        <div hidden$="{{!char.residence}}">Residence: {{char.residence}}</div>
                    </div>

                </div>

                <div id="charProfile" hidden$="{{!char.profile}}">
                    <div>Profile: {{char.profile}}</div>
                </div>

                <div class="card-actions">
                    <a href="/characters/edit/{{char.index}}" tabindex="-1">
                        <paper-icon-button icon="editor:mode-edit" hidden$="{{allowEdit}}">
                        </paper-icon-button>
                    </a>
                </div>

            </paper-card>

        </div>

    </template>
    <script>
        Polymer({
            is: 'ut-char-card',
            properties: {
                charData: {
                    type: Object,
                    notify: true
                },
                charId: {
                    type: String,
                    notify: true
                },
                char: {
                    type: Object,
                    notify: true,
                    computed: '_computeChar(charData, charId)'
                },
                _validCharSelected: {
                    type: Boolean,
                    notify: true,
                    value: false
                }
            },
            _toJSON: function (data) {
                return JSON.stringify(data);
            },

            _computeChar: function (charData, charId) {
                if (charData) {
                    if (charData.characters[charId]) {
                        this._validCharSelected = true;
                        return this.charData.characters[charId];
                    } else {
                        this._validCharSelected = false;
                        return undefined;
                    }
                } else {
                    this._validCharSelected = false;
                }
            }
        });
    </script>

</dom-module>